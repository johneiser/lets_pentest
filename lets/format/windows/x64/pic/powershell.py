from lets.__module__ import Module


class PowerShell(Module):
    """
    Format Windows x64 position-independent code (PIC) into PowerShell.
    """
    images = [
        "local/metasploit:1.0.0",   # amd64 only!
        ]

    @classmethod
    def add_arguments(cls, parser):
        pass

    def handle(self, input):
        assert input is not None, "Must provide windows x64 pic as input"

        import lets.generate.payload.msfvenom as msfvenom

        for data in input:
            yield msfvenom.run_formatter("psh-reflection", data)
