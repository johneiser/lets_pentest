from lets.__module__ import Module
import base64


class JS(Module):
    """
    Wrap a Visual Basic Script (.vbs, .vbe) as JavaScript using HTML smuggling.
    """

    @classmethod
    def add_arguments(self, parser):
        parser.add_argument("-n", "--name", type=str, default="test.vbs",
            help="name of the script (%(default)s)")
        parser.add_argument("-t", "--type", type=str, default="application/x-vbs",
            help="mimetype of download (%(default)s)")

    def handle(self, input, name="test.vbs", type="application/x-vbs"):
        assert input is not None, "Must provide script as input"

        # Invoke generic HTML smuggling
        import lets.format.exe.js as encode
        for result in iter(encode.handle(input, name, type)):
            yield result
