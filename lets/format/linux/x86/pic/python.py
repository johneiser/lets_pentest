from lets.__module__ import Module


class Python(Module):
    """
    Format Linux x86 position-independent code (PIC) into python.
    """
    images = [
        "local/metasploit:1.0.0",   # amd64 only!
        ]

    @classmethod
    def add_arguments(cls, parser):
        pass

    def handle(self, input):
        assert input is not None, "Must provide linux x86 pic as input"

        import lets.generate.payload.msfvenom as msfvenom

        for data in input:
            yield msfvenom.run_formatter("python-reflection", data)
