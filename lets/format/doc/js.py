from lets.__module__ import Module
import base64


class JS(Module):
    """
    Wrap a Microsoft Word Document (.doc, docx, .docm) as JavaScript using HTML smuggling.
    """

    @classmethod
    def add_arguments(self, parser):
        parser.add_argument("-n", "--name", type=str, default="test.doc",
            help="name of the document (%(default)s)")
        parser.add_argument("-t", "--type", type=str, default="application/msword",
            help="mimetype of download (%(default)s)")

    def handle(self, input, name="test.doc", type="application/msword"):
        assert input is not None, "Must provide document as input"

        # Invoke generic HTML smuggling
        import lets.format.exe.js as encode
        for result in iter(encode.handle(input, name, type)):
            yield result
