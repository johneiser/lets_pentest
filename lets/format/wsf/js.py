from lets.__module__ import Module
import base64


class JS(Module):
    """
    Wrap a Windows Script File (.wsf) as JavaScript using HTML smuggling.
    """

    @classmethod
    def add_arguments(self, parser):
        parser.add_argument("-n", "--name", type=str, default="test.wsf",
            help="name of the file (%(default)s)")
        parser.add_argument("-t", "--type", type=str, default="text/xml",
            help="mimetype of download (%(default)s)")

    def handle(self, input, name="test.wsf", type="text/xml"):
        assert input is not None, "Must provide file as input"

        # Invoke generic HTML smuggling
        import lets.format.exe.js as encode
        for result in iter(encode.handle(input, name, type)):
            yield result
